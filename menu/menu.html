<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="menu.css">

    <title>menu</title>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
      import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDImyxdSlB0Yr0PdMx32nVccGt7n3zMWZw",
  authDomain: "gharvedtan-auth.firebaseapp.com",
  projectId: "gharvedtan-auth",
  storageBucket: "gharvedtan-auth.firebasestorage.app",
  messagingSenderId: "32502650170",
  appId: "1:32502650170:web:8268b4c5947d5f04ab6c03"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      const searchInput = document.getElementById("searchInput");
      const searchBtn = document.getElementById("searchBtn");
      const catalogue = document.querySelector(".popular-foods__catalogue");

      async function fetchAndDisplayItems(searchTerm = "") {
        catalogue.innerHTML = "Loading...";
        let q = collection(db, "menuItems");

        const querySnapshot = await getDocs(q);
        catalogue.innerHTML = "";

        querySnapshot.forEach(doc => {
          const item = doc.data();
          if (
            item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            item.sellerName.toLowerCase().includes(searchTerm.toLowerCase())
          ) {
            const card = 
              <article class="popular-foods__card">
                <img class="popular-foods__card-image" src="${item.photoUrl}" alt="${item.name}" />
                <h1 class="popular-foods__card-seller">${item.sellerName}</h1>
                <h4 class="popular-foods__card-title">${item.name}</h4>

                <div class="popular-foods__card-details flex-between">
                    <div class="popular-foods__card-rating">
                        <img src="/assets/star.svg" alt="star" />
                        <p>${item.rating}</p>
                    </div>
                    <p class="popular-foods__card-price">â‚¹${item.price}</p>
                </div>
                <div class="subscription__form">
                    <button>Add to Cart</button>
                </div>
              </article>
            ;
            catalogue.innerHTML += card;
          }
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        fetchAndDisplayItems();
        searchBtn.addEventListener("click", () => {
          fetchAndDisplayItems(searchInput.value);
        });
      });
    </script>
</head>

<body>

<header>...</header>

<section class="layer-container">...</section>

<section class="popular-foods" id="menu">
  <div class="subscription__form1" data-aos="fade-up">
    <input id="searchInput" type="text" placeholder="Search for your favourite comfort food" />
    <button id="searchBtn"><img src="/assets/search.svg"></button>
  </div>

<div class="popular-foods__filters hide-scrollbar" data-aos="fade-up">
  <button class="popular-foods__filter-btn active" data-region="all">All</button>
  <button class="popular-foods__filter-btn" data-region="south">South Indian</button>
  <button class="popular-foods__filter-btn" data-region="north">North Indian</button>
  <button class="popular-foods__filter-btn" data-region="west">West Indian</button>
  <button class="popular-foods__filter-btn" data-region="east">East Indian</button>
  <button class="popular-foods__filter-btn" data-region="central">Central Indian</button>
</div>



  <div class="popular-foods__catalogue" data-aos="fade-up">
    <!-- Firebase items will render here -->
  </div>
</section>

<footer>...</footer>
<script type="module" src="./firebase.js"></script>
<script type="module" src="./menu.js"></script>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="/js/indexjs.js"></script>
</body>

</html>